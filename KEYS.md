# Atlas - Keys

## Algorithm

**Ed25519**, 32-byte keys. No seed phrases; keys are generated randomly with proof-of-work.

## Tiers

Valid public keys embed their tier in the raw key bytes. Keys are generated by sampling random Ed25519 pairs until the raw public key, base64-encoded, starts with the tier prefix.

| Tier | Name    | Base64 prefix | Access                           |
| ---- | ------- | ------------- | -------------------------------- |
| 1    | Citizen | `cit`         | Read-only                        |
| 2    | Titan   | `tita`        | Read/write                       |
| 3    | Atlas   | `atlas`       | Full access + highest privileges |

Keys not matching any prefix are rejected. Generation requires â‰¥ 2 GB RAM.

## Format

Keys are encoded as **Bech32**: `<HRP> "1" <base32-data> <6-char BCH checksum>`.

Atlas uses a compact form that strips the `1` separator (and HRP for private keys):

| Key type    | HRP    | Canonical (compact) stored form   | Also accepted                                    |
| ----------- | ------ | --------------------------------- | ------------------------------------------------ |
| Public key  | `apub` | `apub<data><checksum>`            | `apub1...`, `cit...`, `tita...`, `atlas...`, SPKI Base64, PEM |
| Private key | `asec` | `<data><checksum>`                | `asec1...`, `nsec1...` (Nostr), PKCS8 Base64, PEM |

## DER prefixes (internal)

| Key type    | Encoding | Hex prefix                               |
| ----------- | -------- | ---------------------------------------- |
| Public key  | SPKI     | `302a300506032b6570032100`               |
| Private key | PKCS8    | `302e020100300506032b657004220420`       |

Raw 32-byte key material is appended directly after the prefix.

## Backup encryption

Private key backups are encrypted client-side. Format: `atlas-backup-v1.<base64(salt || iv || ciphertext)>`

- KDF: PBKDF2-SHA256, 100,000 iterations, 16-byte salt
- Encryption: AES-256-GCM, 12-byte IV
